SELECT DISTINCT (TBL_JOB.JOB_NAME+' - '+TBL_DEPARTMENT.DEPT_NAME), " 
				  TBL_COMPETENCY.COMPETENCY_NAME, TBL_JOB_COMPETENCY.JOB_COMPETENCY_COMPETENCY_LEVEL, (TBL_EMPLOYEE.EMP_LAST_NAME+', '+ "
				  TBL_EMPLOYEE.EMP_FIRST_NAME), COALESCE(TBL_COMPETENCY_STATUS.COMPETENCY_STATUS_COMPETENCY_SCORE,'NO COMPETENCY') AS VALUE, "
				  CASE WHEN TBL_COMPETENCY_STATUS.COMPETENCY_STATUS_COMPETENCY_SCORE IS NULL THEN 'NO COMPETENCY' WHEN "
				  TBL_COMPETENCY_STATUS.COMPETENCY_STATUS_COMPETENCY_SCORE ='BASIC' AND JOB_COMPETENCY_COMPETENCY_LEVEL='INTERMEDIATE' "  
				  OR JOB_COMPETENCY_COMPETENCY_LEVEL='ADVANCED' OR JOB_COMPETENCY_COMPETENCY_LEVEL='SUPERIOR' THEN 'NEEDS IMPROVEMENT' "
				  WHEN TBL_COMPETENCY_STATUS.COMPETENCY_STATUS_COMPETENCY_SCORE ='ADVANCED' AND JOB_COMPETENCY_COMPETENCY_LEVEL='SUPERIOR' "  
				 THEN 'NEEDS IMPROVEMENT' WHEN TBL_COMPETENCY_STATUS.COMPETENCY_STATUS_COMPETENCY_SCORE ='INTERMEDIATE' AND  "
				  JOB_COMPETENCY_COMPETENCY_LEVEL='ADVANCED'  OR JOB_COMPETENCY_COMPETENCY_LEVEL='SUPERIOR' THEN  'NEEDS IMPROVEMENT'  "
				  ELSE 'DESIRED LEVEL ATTAINED' END AS SCORE FROM TBL_JOB "
				  INNER JOIN TBL_JOB_COMPETENCY ON TBL_JOB.JOB_ID =  "
				  $P{jobid} "
				  INNER JOIN REF_EMP_JOB ON $P{jobid}=REF_EMP_JOB.JOB_ID "
				  INNER JOIN TBL_EMPLOYEE ON REF_EMP_JOB.EMP_ID=$P{employeeid}
				  LEFT JOIN TBL_COMPETENCY_STATUS ON TBL_JOB_COMPETENCY.JOB_COMPETENCY_COMPETENCY_ID = "
				  TBL_COMPETENCY_STATUS.COMPETENCY_STATUS_COMPETENCY_ID AND TBL_COMPETENCY_STATUS.COMPETENCY_STATUS_EMP_ID=TBL_EMPLOYEE.EMP_ID " 
				  INNER JOIN TBL_COMPETENCY ON TBL_JOB_COMPETENCY.JOB_COMPETENCY_COMPETENCY_ID = TBL_COMPETENCY.COMPETENCY_ID "
				  LEFT JOIN TBL_DEPARTMENT ON TBL_JOB.DEPT_ID = TBL_DEPARTMENT.DEPT_ID   "
				+ "WHERE TBL_EMPLOYEE.EMP_ID=$P{employeeid} AND REF_EMP_JOB.EMP_ID=$P{employeeid} AND REF_EMP_JOB.JOB_ID=$P{jobid}